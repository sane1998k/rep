let buttonReport=document.querySelector(".report"),buttonGraph=document.querySelector(".graph"),buttonContacts=document.querySelector(".contacts"),actionReport=document.querySelector(".action-report"),actionGraph=document.querySelector(".action-graph"),actionContacts=document.querySelector(".action-contacts");buttonReport.addEventListener("click",(function(t){buttonReport.classList.contains("on")?actionReport.style.display="block":(actionReport.style.display="block",buttonReport.classList.add("on"),buttonContacts.classList.remove("on"),buttonGraph.classList.remove("on"),actionGraph.style.display="none",actionContacts.style.display="none")})),buttonGraph.addEventListener("click",(function(t){console.log(seriesOptions),buttonGraph.classList.contains("on")?actionGraph.style.display="block":(buttonGraph.classList.add("on"),buttonReport.classList.remove("on"),buttonContacts.classList.remove("on"),actionGraph.style.display="block",actionReport.style.display="none",actionContacts.style.display="none")})),buttonContacts.addEventListener("click",(function(t){buttonContacts.classList.contains("on")?actionContacts.style.display="block":(buttonContacts.classList.add("on"),buttonGraph.classList.remove("on"),buttonReport.classList.remove("on"),actionContacts.style.display="block",actionReport.style.display="none",actionGraph.style.display="none")}));var seriesOptions=[],seriesCounter=0,names=["MSFT","AAPL","GOOG"],nameOfDoz=["Дозатор 3","Дозатор 1","Дозатор 2"],dataSum=0;function drawJson(t,e){Highcharts.getJSON("./php/msft-c.php?dateTo="+t+"&dateFrom="+e,success),Highcharts.getJSON("./php/aapl-c.php?dateTo="+t+"&dateFrom="+e,success),Highcharts.getJSON("./php/goog-c.php?dateTo="+t+"&dateFrom="+e,success),seriesCounter=0}function doz1(){$.ajax({type:"POST",url:"./php/dos1.php",dataType:"json",data:{dateTo:$("input[id=to]").val(),dateFrom:$("input[id=from]").val()},success:function(t){var e;if("ok"==t.status)for(let a=0;a<t.result.length;a++)e=new Date(t.result[a][0]),t.result[a][0]=e.getTime()-6e4*e.getTimezoneOffset();else alert("Данные не найдены...")}})}function doz2(){$.ajax({type:"POST",url:"./php/dos2.php",dataType:"json",data:{dateTo:$("input[id=to]").val(),dateFrom:$("input[id=from]").val()},success:function(t){if("ok"==t.status){var e;for(let a=0;a<t.result.length;a++)e=new Date(t.result[a][0]),t.result[a][0]=e.getTime()-6e4*e.getTimezoneOffset();return t.result}alert("Данные не найдены...")}})}function doz3(){$.ajax({type:"POST",url:"./php/dos3.php",dataType:"json",data:{dateTo:$("input[id=to]").val(),dateFrom:$("input[id=from]").val()},success:function(t){if("ok"==t.status){var e;for(let a=0;a<t.result.length;a++)e=new Date(t.result[a][0]),t.result[a][0]=e.getTime()-6e4*e.getTimezoneOffset();console.log("1"+seriesOptions[0]+"2 "+seriesOptions[1]+" 3"+seriesOptions[2])}else alert("Данные не найдены...")}})}function draw_chart(){$.getJSON("./php/aapl-c.php",{dateTo:$("input[id=to]").val(),dateFrom:$("input[id=from]").val()},(function(t){console.log("sula"),console.log(t);var e={chart:{renderTo:"container",type:"column"},xAxis:{type:"datetime"},yAxis:{title:{text:"test"}},series:[{data:t,name:"name"}]};chart=new Highcharts.Chart(e)}))}function createChart(){Highcharts.setOptions({global:{useUTC:!1},lang:{downloadPNG:"Скачать PNG",downloadJPEG:"Скачать JPEG",downloadPDF:"Скачать PDF",downloadSVG:"Скачать SVG",downloadCSV:"Скачать CSV",downloadXLS:"Скачать XLS",loading:"Загрузка...",exportButtonTitle:"Экспорт",printButtonTitle:"Печать",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],shortMonths:["Янв","Фев","Март","Апр","Май","Июнь","Июль","Авг","Сент","Окт","Нояб","Дек"],printButtonTitle:"Imprimir Gr├ífico",resetZoom:"Limpar Zoom",weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],printChart:"Напечатать график",viewFullscreen:"Полноэкранный режим",exitFullscreen:"Выйти из полноэкранного режима",viewData:"Отобразить таблицу",hideData:"Скрыть таблицу"}}),Highcharts.stockChart("container",{chart:{type:"column"},credits:{text:"автоматика-м",href:'javascript:window.open("http://prom-service.org", "_blank")',target:"_blank",style:{fontSize:"15px"}},rangeSelectorZoom:"Увеличить",rangeSelector:{selected:4,buttons:[{type:"day",count:1,text:"1д"},{type:"month",count:1,text:"1м"},{type:"month",count:6,text:"6м"},{type:"year",count:1,text:"1г"},{type:"all",text:"Всё"}]},yAxis:{plotLines:[{value:0,width:4,color:"silver"}]},tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',valueDecimals:2,split:!0},series:seriesOptions})}function success(t){var e=this.url.match(/(msft|aapl|goog)/)[0].toUpperCase(),a=names.indexOf(e);console.log(names.indexOf(e)),seriesOptions[a]={name:nameOfDoz[a],data:t},(seriesCounter+=1)===names.length&&createChart()}$(document).ready((function(){var t=d.getFullYear()+"-"+zeroPadded(d.getMonth())+"-"+zeroPadded(d.getDate())+"T00:00:01",e=d.getFullYear()+"-"+zeroPadded(d.getMonth()+1)+"-"+zeroPadded(d.getDate())+"T23:59:59";drawJson(e,t),$("input[id=from2]").val(t),$("input[id=to2]").val(e)})),$("#search-graph").click((function(t){drawJson($("#to2").val(),$("#from2").val()),seriesCounter=0})),$(document).ready((function(){}));var tbody=$("<tbody />"),searchReport=$("#search-report"),counter=["Всего","",0,0,0,0,0];function zeroPadded(t){return t>=10?t:"0"+t}function update(){$("#DataTable").dataTable().fnClearTable(),counter[2]=0,counter[3]=0,counter[4]=0,counter[5]=0,counter[6]=0;$("#DataTable").find("tbody");$.ajax({type:"POST",url:"./php/getBuild.php",dataType:"json",data:{dateTo:$("input[id=to]").val(),dateFrom:$("input[id=from]").val()},success:function(t){if("ok"==t.status){""!=t.result&&$("#DataTable").dataTable().fnAddData(t.result);for(var e=0;e<t.result.length;e++)counter[2]+=parseFloat(t.result[e][2]),counter[3]+=parseFloat(t.result[e][3]),counter[4]+=parseFloat(t.result[e][4]),counter[5]+=parseFloat(t.result[e][5]),counter[6]+=parseFloat(t.result[e][6]);$("#DataTable").dataTable().fnAddData(counter)}else alert("Данные не найдены...")}})}function del(){for(var t=0;t<=400;t++){null!==(e=document.getElementById("DataTable"))&&e.parentNode.removeChild(e)}for(t=0;t<=400;t++){var e;null!==(e=document.getElementById("DataTable_wrapper"))&&e.parentNode.removeChild(e)}return!1}function drawTable(t){var e=$("<table/>");e.attr("id","DataTable"),e.addClass("dataTable");var a=$("<thead>"),o=$("<tr />");e.append(o),o.append($("<th>Д. Начала</th>")),o.append($("<th>Д. Окончания</th>")),o.append($("<th>Общее задание</th>")),o.append($("<th>Сумма доз. 1</th>")),o.append($("<th>Сумма доз. 2</th>")),o.append($("<th>Сумма доз. 3</th>")),o.append($("<th>Общая сумма</th>")),a.append(o),e.append(a);var n=$("<tfoot />"),r=$("<tr />");r.append($("<th>Д. Начала</th>")),r.append($("<th>Д. Окончания</th>")),r.append($("<th>Общее задание</th>")),r.append($("<th>Сумма доз. 1</th>")),r.append($("<th>Сумма доз. 2</th>")),r.append($("<th>Сумма доз. 3</th>")),r.append($("<th>Общая сумма</th>")),n.append(r),e.append(n);for(var d=0;d<t.length;d++)drawRow(t[d]);var s=$("<tr />");tbody.append(s),s.append($("<td>"+counter[0]+"</td>")),s.append($("<td>"+counter[1]+"</td>")),s.append($("<td>"+counter[2]+"</td>")),s.append($("<td>"+counter[3]+"</td>")),s.append($("<td>"+counter[4]+"</td>")),s.append($("<td>"+counter[5]+"</td>")),s.append($("<td>"+counter[6]+"</td>")),e.append(tbody),$(".action-report__table").append(e)}function drawRow(t){var e=$("<tr />");tbody.append(e),counter[2]+=parseFloat(t[2]),counter[3]+=parseFloat(t[3]),counter[4]+=parseFloat(t[4]),counter[5]+=parseFloat(t[5]),counter[6]+=parseFloat(t[6]),e.append($("<td>"+t[0]+"</td>")),e.append($("<td>"+t[1]+"</td>")),e.append($("<td>"+t[2]+"</td>")),e.append($("<td>"+t[3]+"</td>")),e.append($("<td>"+t[4]+"</td>")),e.append($("<td>"+t[5]+"</td>")),e.append($("<td>"+t[6]+"</td>"))}function getBuild(){d=new Date;var t=d.getFullYear()+"-"+zeroPadded(d.getMonth())+"-"+zeroPadded(d.getDate())+"T00:00:00",e=d.getFullYear()+"-"+zeroPadded(d.getMonth()+1)+"-"+zeroPadded(d.getDate())+"T23:59:59";$.ajax({type:"POST",url:"./php/getBuild.php",dataType:"json",data:{dateTo:e,dateFrom:t},success:function(t){"ok"==t.status?(drawTable(t.result),t.result=""):alert("Данные не найдены...")}})}function tableSearch(){for(var t=document.getElementById("search-text"),e=document.getElementById("DataTable"),a=new RegExp(t.value,"i"),o=!1,n=1;n<e.rows.length;n++){o=!1;for(var r=e.rows[n].cells.length-1;r>=0&&!(o=a.test(e.rows[n].cells[r].innerHTML));r--);e.rows[n].style.display=o?"":"none"}}$(document).ready((function(){d=new Date;var t=d.getFullYear()+"-"+zeroPadded(d.getMonth()+1)+"-"+zeroPadded(d.getDate())+"T23:59:59",e=d.getFullYear()+"-"+zeroPadded(d.getMonth())+"-"+zeroPadded(d.getDate())+"T00:00:01";$("input[id=from]").val(e),$("input[id=to]").val(t),setTimeout((()=>{$("#DataTable").DataTable({dom:"Bfrtip",pageLength:10,autoWidth:!1,width:"100%",buttons:["excel","pdf"]})}),500)})),getBuild(),searchReport.click((function(t){update()}));